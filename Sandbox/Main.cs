using System;
using System.Numerics;
using System.Collections.Generic;
using System.Windows.Forms;
using System.Text.RegularExpressions;
using SpiceSharp;
using SpiceSharp.Components;
using SpiceSharp.Simulations;
using SpiceSharp.Circuits;

namespace Sandbox
{
    public partial class Main : Form
    {
        /// <summary>
        /// Constructor
        /// </summary>
        public Main()
        {
            InitializeComponent();
            var plotInput = chMain.Series.Add("Input");
            plotInput.ChartType = System.Windows.Forms.DataVisualization.Charting.SeriesChartType.FastPoint;
            var plotOutput = chMain.Series.Add("Output");
            plotOutput.ChartType = System.Windows.Forms.DataVisualization.Charting.SeriesChartType.FastPoint;
            plotOutput.YAxisType = System.Windows.Forms.DataVisualization.Charting.AxisType.Secondary;
            var plotSpice = chMain.Series.Add("Spice 3f5");
            plotSpice.ChartType = System.Windows.Forms.DataVisualization.Charting.SeriesChartType.FastPoint;

            // Create circuit
            double r1 = 100.0;
            double r2 = 500.0;
            double l1 = 10e-3;
            double l2 = 2e-3;
            double k = 0.693;
            Circuit ckt = new Circuit();
            ckt.Objects.Add(
                new Voltagesource("V1", "IN", "0", 1.0), // new Pulse(0, 1, 10e-6, 1e-12, 1e-12, 1, 2)),
                new Resistor("R1", "IN", "1", r1),
                new Inductor("L1", "1", "0", l1),
                new Inductor("L2", "OUT", "0", l2),
                new Resistor("R2", "OUT", "0", r2),
                new MutualInductance("M1", "L1", "L2", k)
                );
            ckt.Nodes.IC["1"] = 0;
            ckt.Objects["L1"].Parameters.Set("ic", 0);

            // Create simulation
            Transient tran = new Transient("tran", 1e-9, 1e-4);
            tran.MaxStep = 1e-6;

            // Create exports
            Func<State, double>[] exports = new Func<State, double>[1];
            tran.InitializeSimulationExport += (object sender, InitializationDataEventArgs args) =>
            {
                exports[0] = tran.CreateVoltageExport("OUT");
            };

            // Create references
            double mut = k * Math.Sqrt(l1 * l2);
            double a = l1 * l2 - mut * mut;
            double b = r1 * l2 + r2 * l1;
            double c = r1 * r2;
            double D = Math.Sqrt(b * b - 4 * a * c);
            double invtau1 = (-b + D) / (2.0 * a);
            double invtau2 = (-b - D) / (2.0 * a);
            double factor = mut * r2 / a / (invtau1 - invtau2);
            Func<double, double>[] references = {(double t) => factor * (Math.Exp(t * invtau1) - Math.Exp(t * invtau2)) };

            double[] reft = { 0.000000000000000e+00, 1.000000000000000e-11, 2.000000000000000e-11, 4.000000000000000e-11, 8.000000000000001e-11, 1.600000000000000e-10, 3.200000000000000e-10, 6.400000000000001e-10, 1.280000000000000e-09, 2.560000000000000e-09, 5.120000000000001e-09, 1.024000000000000e-08, 2.048000000000000e-08, 4.096000000000000e-08, 8.192000000000001e-08, 1.638400000000000e-07, 2.638400000000000e-07, 3.638400000000000e-07, 4.638400000000000e-07, 5.638400000000001e-07, 6.638400000000000e-07, 7.638400000000000e-07, 8.638400000000000e-07, 9.638400000000000e-07, 1.063840000000000e-06, 1.163840000000000e-06, 1.263840000000000e-06, 1.363840000000000e-06, 1.463840000000000e-06, 1.563840000000000e-06, 1.663839999999999e-06, 1.763839999999999e-06, 1.863839999999999e-06, 1.963839999999999e-06, 2.063839999999999e-06, 2.163839999999999e-06, 2.263839999999999e-06, 2.363839999999999e-06, 2.463839999999999e-06, 2.563839999999998e-06, 2.663839999999998e-06, 2.763839999999998e-06, 2.863839999999998e-06, 2.963839999999998e-06, 3.063839999999998e-06, 3.163839999999998e-06, 3.263839999999998e-06, 3.363839999999998e-06, 3.463839999999997e-06, 3.563839999999997e-06, 3.663839999999997e-06, 3.763839999999997e-06, 3.863839999999997e-06, 3.963839999999997e-06, 4.063839999999997e-06, 4.163839999999997e-06, 4.263839999999997e-06, 4.363839999999996e-06, 4.463839999999996e-06, 4.563839999999996e-06, 4.663839999999996e-06, 4.763839999999996e-06, 4.863839999999996e-06, 4.963839999999996e-06, 5.063839999999996e-06, 5.163839999999996e-06, 5.263839999999995e-06, 5.363839999999995e-06, 5.463839999999995e-06, 5.563839999999995e-06, 5.663839999999995e-06, 5.763839999999995e-06, 5.863839999999995e-06, 5.963839999999995e-06, 6.063839999999995e-06, 6.163839999999995e-06, 6.263839999999994e-06, 6.363839999999994e-06, 6.463839999999994e-06, 6.563839999999994e-06, 6.663839999999994e-06, 6.763839999999994e-06, 6.863839999999994e-06, 6.963839999999994e-06, 7.063839999999994e-06, 7.163839999999993e-06, 7.263839999999993e-06, 7.363839999999993e-06, 7.463839999999993e-06, 7.563839999999993e-06, 7.663839999999994e-06, 7.763839999999994e-06, 7.863839999999995e-06, 7.963839999999996e-06, 8.063839999999997e-06, 8.163839999999997e-06, 8.263839999999998e-06, 8.363839999999999e-06, 8.463840000000000e-06, 8.563840000000000e-06, 8.663840000000001e-06, 8.763840000000002e-06, 8.863840000000003e-06, 8.963840000000003e-06, 9.063840000000004e-06, 9.163840000000005e-06, 9.263840000000005e-06, 9.363840000000006e-06, 9.463840000000007e-06, 9.563840000000008e-06, 9.663840000000008e-06, 9.763840000000009e-06, 9.863840000000010e-06, 9.963840000000011e-06, 1.006384000000001e-05, 1.016384000000001e-05, 1.026384000000001e-05, 1.036384000000001e-05, 1.046384000000001e-05, 1.056384000000002e-05, 1.066384000000002e-05, 1.076384000000002e-05, 1.086384000000002e-05, 1.096384000000002e-05, 1.106384000000002e-05, 1.116384000000002e-05, 1.126384000000002e-05, 1.136384000000002e-05, 1.146384000000002e-05, 1.156384000000002e-05, 1.166384000000002e-05, 1.176384000000002e-05, 1.186384000000002e-05, 1.196384000000003e-05, 1.206384000000003e-05, 1.216384000000003e-05, 1.226384000000003e-05, 1.236384000000003e-05, 1.246384000000003e-05, 1.256384000000003e-05, 1.266384000000003e-05, 1.276384000000003e-05, 1.286384000000003e-05, 1.296384000000003e-05, 1.306384000000003e-05, 1.316384000000003e-05, 1.326384000000003e-05, 1.336384000000004e-05, 1.346384000000004e-05, 1.356384000000004e-05, 1.366384000000004e-05, 1.376384000000004e-05, 1.386384000000004e-05, 1.396384000000004e-05, 1.406384000000004e-05, 1.416384000000004e-05, 1.426384000000004e-05, 1.436384000000004e-05, 1.446384000000004e-05, 1.456384000000004e-05, 1.466384000000005e-05, 1.476384000000005e-05, 1.486384000000005e-05, 1.496384000000005e-05, 1.506384000000005e-05, 1.516384000000005e-05, 1.526384000000005e-05, 1.536384000000005e-05, 1.546384000000005e-05, 1.556384000000005e-05, 1.566384000000004e-05, 1.576384000000004e-05, 1.586384000000004e-05, 1.596384000000004e-05, 1.606384000000004e-05, 1.616384000000004e-05, 1.626384000000004e-05, 1.636384000000004e-05, 1.646384000000004e-05, 1.656384000000004e-05, 1.666384000000003e-05, 1.676384000000003e-05, 1.686384000000003e-05, 1.696384000000003e-05, 1.706384000000003e-05, 1.716384000000003e-05, 1.726384000000003e-05, 1.736384000000003e-05, 1.746384000000003e-05, 1.756384000000003e-05, 1.766384000000003e-05, 1.776384000000002e-05, 1.786384000000002e-05, 1.796384000000002e-05, 1.806384000000002e-05, 1.816384000000002e-05, 1.826384000000002e-05, 1.836384000000002e-05, 1.846384000000002e-05, 1.856384000000002e-05, 1.866384000000002e-05, 1.876384000000001e-05, 1.886384000000001e-05, 1.896384000000001e-05, 1.906384000000001e-05, 1.916384000000001e-05, 1.926384000000001e-05, 1.936384000000001e-05, 1.946384000000001e-05, 1.956384000000001e-05, 1.966384000000001e-05, 1.976384000000000e-05, 1.986384000000000e-05, 1.996384000000000e-05, 2.006384000000000e-05, 2.016384000000000e-05, 2.026384000000000e-05, 2.036384000000000e-05, 2.046384000000000e-05, 2.056384000000000e-05, 2.066384000000000e-05, 2.076384000000000e-05, 2.086383999999999e-05, 2.096383999999999e-05, 2.106383999999999e-05, 2.116383999999999e-05, 2.126383999999999e-05, 2.136383999999999e-05, 2.146383999999999e-05, 2.156383999999999e-05, 2.166383999999999e-05, 2.176383999999999e-05, 2.186383999999998e-05, 2.196383999999998e-05, 2.206383999999998e-05, 2.216383999999998e-05, 2.226383999999998e-05, 2.236383999999998e-05, 2.246383999999998e-05, 2.256383999999998e-05, 2.266383999999998e-05, 2.276383999999998e-05, 2.286383999999998e-05, 2.296383999999997e-05, 2.306383999999997e-05, 2.316383999999997e-05, 2.326383999999997e-05, 2.336383999999997e-05, 2.346383999999997e-05, 2.356383999999997e-05, 2.366383999999997e-05, 2.376383999999997e-05, 2.386383999999997e-05, 2.396383999999996e-05, 2.406383999999996e-05, 2.416383999999996e-05, 2.426383999999996e-05, 2.436383999999996e-05, 2.446383999999996e-05, 2.456383999999996e-05, 2.466383999999996e-05, 2.476383999999996e-05, 2.486383999999996e-05, 2.496383999999996e-05, 2.506383999999995e-05, 2.516383999999995e-05, 2.526383999999995e-05, 2.536383999999995e-05, 2.546383999999995e-05, 2.556383999999995e-05, 2.566383999999995e-05, 2.576383999999995e-05, 2.586383999999995e-05, 2.596383999999995e-05, 2.606383999999994e-05, 2.616383999999994e-05, 2.626383999999994e-05, 2.636383999999994e-05, 2.646383999999994e-05, 2.656383999999994e-05, 2.666383999999994e-05, 2.676383999999994e-05, 2.686383999999994e-05, 2.696383999999994e-05, 2.706383999999994e-05, 2.716383999999993e-05, 2.726383999999993e-05, 2.736383999999993e-05, 2.746383999999993e-05, 2.756383999999993e-05, 2.766383999999993e-05, 2.776383999999993e-05, 2.786383999999993e-05, 2.796383999999993e-05, 2.806383999999993e-05, 2.816383999999992e-05, 2.826383999999992e-05, 2.836383999999992e-05, 2.846383999999992e-05, 2.856383999999992e-05, 2.866383999999992e-05, 2.876383999999992e-05, 2.886383999999992e-05, 2.896383999999992e-05, 2.906383999999992e-05, 2.916383999999991e-05, 2.926383999999991e-05, 2.936383999999991e-05, 2.946383999999991e-05, 2.956383999999991e-05, 2.966383999999991e-05, 2.976383999999991e-05, 2.986383999999991e-05, 2.996383999999991e-05, 3.006383999999991e-05, 3.016383999999991e-05, 3.026383999999990e-05, 3.036383999999990e-05, 3.046383999999990e-05, 3.056383999999990e-05, 3.066383999999990e-05, 3.076383999999991e-05, 3.086383999999991e-05, 3.096383999999991e-05, 3.106383999999991e-05, 3.116383999999992e-05, 3.126383999999992e-05, 3.136383999999992e-05, 3.146383999999992e-05, 3.156383999999993e-05, 3.166383999999993e-05, 3.176383999999993e-05, 3.186383999999993e-05, 3.196383999999994e-05, 3.206383999999994e-05, 3.216383999999994e-05, 3.226383999999994e-05, 3.236383999999995e-05, 3.246383999999995e-05, 3.256383999999995e-05, 3.266383999999995e-05, 3.276383999999995e-05, 3.286383999999996e-05, 3.296383999999996e-05, 3.306383999999996e-05, 3.316383999999996e-05, 3.326383999999997e-05, 3.336383999999997e-05, 3.346383999999997e-05, 3.356383999999997e-05, 3.366383999999998e-05, 3.376383999999998e-05, 3.386383999999998e-05, 3.396383999999998e-05, 3.406383999999999e-05, 3.416383999999999e-05, 3.426383999999999e-05, 3.436383999999999e-05, 3.446384000000000e-05, 3.456384000000000e-05, 3.466384000000000e-05, 3.476384000000000e-05, 3.486384000000001e-05, 3.496384000000001e-05, 3.506384000000001e-05, 3.516384000000001e-05, 3.526384000000002e-05, 3.536384000000002e-05, 3.546384000000002e-05, 3.556384000000002e-05, 3.566384000000003e-05, 3.576384000000003e-05, 3.586384000000003e-05, 3.596384000000003e-05, 3.606384000000004e-05, 3.616384000000004e-05, 3.626384000000004e-05, 3.636384000000004e-05, 3.646384000000004e-05, 3.656384000000005e-05, 3.666384000000005e-05, 3.676384000000005e-05, 3.686384000000005e-05, 3.696384000000006e-05, 3.706384000000006e-05, 3.716384000000006e-05, 3.726384000000006e-05, 3.736384000000007e-05, 3.746384000000007e-05, 3.756384000000007e-05, 3.766384000000007e-05, 3.776384000000008e-05, 3.786384000000008e-05, 3.796384000000008e-05, 3.806384000000008e-05, 3.816384000000009e-05, 3.826384000000009e-05, 3.836384000000009e-05, 3.846384000000009e-05, 3.856384000000010e-05, 3.866384000000010e-05, 3.876384000000010e-05, 3.886384000000010e-05, 3.896384000000011e-05, 3.906384000000011e-05, 3.916384000000011e-05, 3.926384000000011e-05, 3.936384000000012e-05, 3.946384000000012e-05, 3.956384000000012e-05, 3.966384000000012e-05, 3.976384000000013e-05, 3.986384000000013e-05, 3.996384000000013e-05, 4.006384000000013e-05, 4.016384000000013e-05, 4.026384000000014e-05, 4.036384000000014e-05, 4.046384000000014e-05, 4.056384000000014e-05, 4.066384000000015e-05, 4.076384000000015e-05, 4.086384000000015e-05, 4.096384000000015e-05, 4.106384000000016e-05, 4.116384000000016e-05, 4.126384000000016e-05, 4.136384000000016e-05, 4.146384000000017e-05, 4.156384000000017e-05, 4.166384000000017e-05, 4.176384000000017e-05, 4.186384000000018e-05, 4.196384000000018e-05, 4.206384000000018e-05, 4.216384000000018e-05, 4.226384000000019e-05, 4.236384000000019e-05, 4.246384000000019e-05, 4.256384000000019e-05, 4.266384000000020e-05, 4.276384000000020e-05, 4.286384000000020e-05, 4.296384000000020e-05, 4.306384000000021e-05, 4.316384000000021e-05, 4.326384000000021e-05, 4.336384000000021e-05, 4.346384000000022e-05, 4.356384000000022e-05, 4.366384000000022e-05, 4.376384000000022e-05, 4.386384000000022e-05, 4.396384000000023e-05, 4.406384000000023e-05, 4.416384000000023e-05, 4.426384000000023e-05, 4.436384000000024e-05, 4.446384000000024e-05, 4.456384000000024e-05, 4.466384000000024e-05, 4.476384000000025e-05, 4.486384000000025e-05, 4.496384000000025e-05, 4.506384000000025e-05, 4.516384000000026e-05, 4.526384000000026e-05, 4.536384000000026e-05, 4.546384000000026e-05, 4.556384000000027e-05, 4.566384000000027e-05, 4.576384000000027e-05, 4.586384000000027e-05, 4.596384000000028e-05, 4.606384000000028e-05, 4.616384000000028e-05, 4.626384000000028e-05, 4.636384000000029e-05, 4.646384000000029e-05, 4.656384000000029e-05, 4.666384000000029e-05, 4.676384000000030e-05, 4.686384000000030e-05, 4.696384000000030e-05, 4.706384000000030e-05, 4.716384000000030e-05, 4.726384000000031e-05, 4.736384000000031e-05, 4.746384000000031e-05, 4.756384000000031e-05, 4.766384000000032e-05, 4.776384000000032e-05, 4.786384000000032e-05, 4.796384000000032e-05, 4.806384000000033e-05, 4.816384000000033e-05, 4.826384000000033e-05, 4.836384000000033e-05, 4.846384000000034e-05, 4.856384000000034e-05, 4.866384000000034e-05, 4.876384000000034e-05, 4.886384000000035e-05, 4.896384000000035e-05, 4.906384000000035e-05, 4.916384000000035e-05, 4.926384000000036e-05, 4.936384000000036e-05, 4.946384000000036e-05, 4.956384000000036e-05, 4.966384000000037e-05, 4.976384000000037e-05, 4.986384000000037e-05, 4.996384000000037e-05, 5.006384000000038e-05, 5.016384000000038e-05, 5.026384000000038e-05, 5.036384000000038e-05, 5.046384000000039e-05, 5.056384000000039e-05, 5.066384000000039e-05, 5.076384000000039e-05, 5.086384000000039e-05, 5.096384000000040e-05, 5.106384000000040e-05, 5.116384000000040e-05, 5.126384000000040e-05, 5.136384000000041e-05, 5.146384000000041e-05, 5.156384000000041e-05, 5.166384000000041e-05, 5.176384000000042e-05, 5.186384000000042e-05, 5.196384000000042e-05, 5.206384000000042e-05, 5.216384000000043e-05, 5.226384000000043e-05, 5.236384000000043e-05, 5.246384000000043e-05, 5.256384000000044e-05, 5.266384000000044e-05, 5.276384000000044e-05, 5.286384000000044e-05, 5.296384000000045e-05, 5.306384000000045e-05, 5.316384000000045e-05, 5.326384000000045e-05, 5.336384000000046e-05, 5.346384000000046e-05, 5.356384000000046e-05, 5.366384000000046e-05, 5.376384000000047e-05, 5.386384000000047e-05, 5.396384000000047e-05, 5.406384000000047e-05, 5.416384000000048e-05, 5.426384000000048e-05, 5.436384000000048e-05, 5.446384000000048e-05, 5.456384000000048e-05, 5.466384000000049e-05, 5.476384000000049e-05, 5.486384000000049e-05, 5.496384000000049e-05, 5.506384000000050e-05, 5.516384000000050e-05, 5.526384000000050e-05, 5.536384000000050e-05, 5.546384000000051e-05, 5.556384000000051e-05, 5.566384000000051e-05, 5.576384000000051e-05, 5.586384000000052e-05, 5.596384000000052e-05, 5.606384000000052e-05, 5.616384000000052e-05, 5.626384000000053e-05, 5.636384000000053e-05, 5.646384000000053e-05, 5.656384000000053e-05, 5.666384000000054e-05, 5.676384000000054e-05, 5.686384000000054e-05, 5.696384000000054e-05, 5.706384000000055e-05, 5.716384000000055e-05, 5.726384000000055e-05, 5.736384000000055e-05, 5.746384000000056e-05, 5.756384000000056e-05, 5.766384000000056e-05, 5.776384000000056e-05, 5.786384000000057e-05, 5.796384000000057e-05, 5.806384000000057e-05, 5.816384000000057e-05, 5.826384000000057e-05, 5.836384000000058e-05, 5.846384000000058e-05, 5.856384000000058e-05, 5.866384000000058e-05, 5.876384000000059e-05, 5.886384000000059e-05, 5.896384000000059e-05, 5.906384000000059e-05, 5.916384000000060e-05, 5.926384000000060e-05, 5.936384000000060e-05, 5.946384000000060e-05, 5.956384000000061e-05, 5.966384000000061e-05, 5.976384000000061e-05, 5.986384000000061e-05, 5.996384000000062e-05, 6.006384000000062e-05, 6.016384000000062e-05, 6.026384000000062e-05, 6.036384000000063e-05, 6.046384000000063e-05, 6.056384000000063e-05, 6.066384000000063e-05, 6.076384000000064e-05, 6.086384000000064e-05, 6.096384000000064e-05, 6.106384000000064e-05, 6.116384000000064e-05, 6.126384000000064e-05, 6.136384000000064e-05, 6.146384000000065e-05, 6.156384000000065e-05, 6.166384000000065e-05, 6.176384000000065e-05, 6.186384000000066e-05, 6.196384000000066e-05, 6.206384000000066e-05, 6.216384000000066e-05, 6.226384000000067e-05, 6.236384000000067e-05, 6.246384000000067e-05, 6.256384000000067e-05, 6.266384000000067e-05, 6.276384000000068e-05, 6.286384000000068e-05, 6.296384000000068e-05, 6.306384000000068e-05, 6.316384000000069e-05, 6.326384000000069e-05, 6.336384000000069e-05, 6.346384000000069e-05, 6.356384000000070e-05, 6.366384000000070e-05, 6.376384000000070e-05, 6.386384000000070e-05, 6.396384000000071e-05, 6.406384000000071e-05, 6.416384000000071e-05, 6.426384000000071e-05, 6.436384000000072e-05, 6.446384000000072e-05, 6.456384000000072e-05, 6.466384000000072e-05, 6.476384000000073e-05, 6.486384000000073e-05, 6.496384000000073e-05, 6.506384000000073e-05, 6.516384000000074e-05, 6.526384000000074e-05, 6.536384000000074e-05, 6.546384000000074e-05, 6.556384000000075e-05, 6.566384000000075e-05, 6.576384000000075e-05, 6.586384000000075e-05, 6.596384000000076e-05, 6.606384000000076e-05, 6.616384000000076e-05, 6.626384000000076e-05, 6.636384000000076e-05, 6.646384000000077e-05, 6.656384000000077e-05, 6.666384000000077e-05, 6.676384000000077e-05, 6.686384000000078e-05, 6.696384000000078e-05, 6.706384000000078e-05, 6.716384000000078e-05, 6.726384000000079e-05, 6.736384000000079e-05, 6.746384000000079e-05, 6.756384000000079e-05, 6.766384000000080e-05, 6.776384000000080e-05, 6.786384000000080e-05, 6.796384000000080e-05, 6.806384000000081e-05, 6.816384000000081e-05, 6.826384000000081e-05, 6.836384000000081e-05, 6.846384000000082e-05, 6.856384000000082e-05, 6.866384000000082e-05, 6.876384000000082e-05, 6.886384000000083e-05, 6.896384000000083e-05, 6.906384000000083e-05, 6.916384000000083e-05, 6.926384000000084e-05, 6.936384000000084e-05, 6.946384000000084e-05, 6.956384000000084e-05, 6.966384000000085e-05, 6.976384000000085e-05, 6.986384000000085e-05, 6.996384000000085e-05, 7.006384000000085e-05, 7.016384000000086e-05, 7.026384000000086e-05, 7.036384000000086e-05, 7.046384000000086e-05, 7.056384000000087e-05, 7.066384000000087e-05, 7.076384000000087e-05, 7.086384000000087e-05, 7.096384000000088e-05, 7.106384000000088e-05, 7.116384000000088e-05, 7.126384000000088e-05, 7.136384000000089e-05, 7.146384000000089e-05, 7.156384000000089e-05, 7.166384000000089e-05, 7.176384000000090e-05, 7.186384000000090e-05, 7.196384000000090e-05, 7.206384000000090e-05, 7.216384000000091e-05, 7.226384000000091e-05, 7.236384000000091e-05, 7.246384000000091e-05, 7.256384000000092e-05, 7.266384000000092e-05, 7.276384000000092e-05, 7.286384000000092e-05, 7.296384000000093e-05, 7.306384000000093e-05, 7.316384000000093e-05, 7.326384000000093e-05, 7.336384000000094e-05, 7.346384000000094e-05, 7.356384000000094e-05, 7.366384000000094e-05, 7.376384000000094e-05, 7.386384000000095e-05, 7.396384000000095e-05, 7.406384000000095e-05, 7.416384000000095e-05, 7.426384000000096e-05, 7.436384000000096e-05, 7.446384000000096e-05, 7.456384000000096e-05, 7.466384000000097e-05, 7.476384000000097e-05, 7.486384000000097e-05, 7.496384000000097e-05, 7.506384000000098e-05, 7.516384000000098e-05, 7.526384000000098e-05, 7.536384000000098e-05, 7.546384000000099e-05, 7.556384000000099e-05, 7.566384000000099e-05, 7.576384000000099e-05, 7.586384000000100e-05, 7.596384000000100e-05, 7.606384000000100e-05, 7.616384000000100e-05, 7.626384000000101e-05, 7.636384000000101e-05, 7.646384000000101e-05, 7.656384000000101e-05, 7.666384000000102e-05, 7.676384000000102e-05, 7.686384000000102e-05, 7.696384000000102e-05, 7.706384000000102e-05, 7.716384000000103e-05, 7.726384000000103e-05, 7.736384000000103e-05, 7.746384000000103e-05, 7.756384000000104e-05, 7.766384000000104e-05, 7.776384000000104e-05, 7.786384000000104e-05, 7.796384000000105e-05, 7.806384000000105e-05, 7.816384000000105e-05, 7.826384000000105e-05, 7.836384000000106e-05, 7.846384000000106e-05, 7.856384000000106e-05, 7.866384000000106e-05, 7.876384000000107e-05, 7.886384000000107e-05, 7.896384000000107e-05, 7.906384000000107e-05, 7.916384000000108e-05, 7.926384000000108e-05, 7.936384000000108e-05, 7.946384000000108e-05, 7.956384000000109e-05, 7.966384000000109e-05, 7.976384000000109e-05, 7.986384000000109e-05, 7.996384000000110e-05, 8.006384000000110e-05, 8.016384000000110e-05, 8.026384000000110e-05, 8.036384000000111e-05, 8.046384000000111e-05, 8.056384000000111e-05, 8.066384000000111e-05, 8.076384000000111e-05, 8.086384000000112e-05, 8.096384000000112e-05, 8.106384000000112e-05, 8.116384000000112e-05, 8.126384000000113e-05, 8.136384000000113e-05, 8.146384000000113e-05, 8.156384000000113e-05, 8.166384000000114e-05, 8.176384000000114e-05, 8.186384000000114e-05, 8.196384000000114e-05, 8.206384000000115e-05, 8.216384000000115e-05, 8.226384000000115e-05, 8.236384000000115e-05, 8.246384000000116e-05, 8.256384000000116e-05, 8.266384000000116e-05, 8.276384000000116e-05, 8.286384000000117e-05, 8.296384000000117e-05, 8.306384000000117e-05, 8.316384000000117e-05, 8.326384000000118e-05, 8.336384000000118e-05, 8.346384000000118e-05, 8.356384000000118e-05, 8.366384000000119e-05, 8.376384000000119e-05, 8.386384000000119e-05, 8.396384000000119e-05, 8.406384000000120e-05, 8.416384000000120e-05, 8.426384000000120e-05, 8.436384000000120e-05, 8.446384000000120e-05, 8.456384000000121e-05, 8.466384000000121e-05, 8.476384000000121e-05, 8.486384000000121e-05, 8.496384000000122e-05, 8.506384000000122e-05, 8.516384000000122e-05, 8.526384000000122e-05, 8.536384000000123e-05, 8.546384000000123e-05, 8.556384000000123e-05, 8.566384000000123e-05, 8.576384000000124e-05, 8.586384000000124e-05, 8.596384000000124e-05, 8.606384000000124e-05, 8.616384000000125e-05, 8.626384000000125e-05, 8.636384000000125e-05, 8.646384000000125e-05, 8.656384000000126e-05, 8.666384000000126e-05, 8.676384000000126e-05, 8.686384000000126e-05, 8.696384000000127e-05, 8.706384000000127e-05, 8.716384000000127e-05, 8.726384000000127e-05, 8.736384000000128e-05, 8.746384000000128e-05, 8.756384000000128e-05, 8.766384000000128e-05, 8.776384000000129e-05, 8.786384000000129e-05, 8.796384000000129e-05, 8.806384000000129e-05, 8.816384000000129e-05, 8.826384000000130e-05, 8.836384000000130e-05, 8.846384000000130e-05, 8.856384000000130e-05, 8.866384000000131e-05, 8.876384000000131e-05, 8.886384000000131e-05, 8.896384000000131e-05, 8.906384000000132e-05, 8.916384000000132e-05, 8.926384000000132e-05, 8.936384000000132e-05, 8.946384000000133e-05, 8.956384000000133e-05, 8.966384000000133e-05, 8.976384000000133e-05, 8.986384000000134e-05, 8.996384000000134e-05, 9.006384000000134e-05, 9.016384000000134e-05, 9.026384000000135e-05, 9.036384000000135e-05, 9.046384000000135e-05, 9.056384000000135e-05, 9.066384000000136e-05, 9.076384000000136e-05, 9.086384000000136e-05, 9.096384000000136e-05, 9.106384000000137e-05, 9.116384000000137e-05, 9.126384000000137e-05, 9.136384000000137e-05, 9.146384000000138e-05, 9.156384000000138e-05, 9.166384000000138e-05, 9.176384000000138e-05, 9.186384000000138e-05, 9.196384000000139e-05, 9.206384000000139e-05, 9.216384000000139e-05, 9.226384000000139e-05, 9.236384000000140e-05, 9.246384000000140e-05, 9.256384000000140e-05, 9.266384000000140e-05, 9.276384000000141e-05, 9.286384000000141e-05, 9.296384000000141e-05, 9.306384000000141e-05, 9.316384000000142e-05, 9.326384000000142e-05, 9.336384000000142e-05, 9.346384000000142e-05, 9.356384000000143e-05, 9.366384000000143e-05, 9.376384000000143e-05, 9.386384000000143e-05, 9.396384000000144e-05, 9.406384000000144e-05, 9.416384000000144e-05, 9.426384000000144e-05, 9.436384000000145e-05, 9.446384000000145e-05, 9.456384000000145e-05, 9.466384000000145e-05, 9.476384000000146e-05, 9.486384000000146e-05, 9.496384000000146e-05, 9.506384000000146e-05, 9.516384000000146e-05, 9.526384000000147e-05, 9.536384000000147e-05, 9.546384000000147e-05, 9.556384000000147e-05, 9.566384000000148e-05, 9.576384000000148e-05, 9.586384000000148e-05, 9.596384000000148e-05, 9.606384000000149e-05, 9.616384000000149e-05, 9.626384000000149e-05, 9.636384000000149e-05, 9.646384000000150e-05, 9.656384000000150e-05, 9.666384000000150e-05, 9.676384000000150e-05, 9.686384000000151e-05, 9.696384000000151e-05, 9.706384000000151e-05, 9.716384000000151e-05, 9.726384000000152e-05, 9.736384000000152e-05, 9.746384000000152e-05, 9.756384000000152e-05, 9.766384000000153e-05, 9.776384000000153e-05, 9.786384000000153e-05, 9.796384000000153e-05, 9.806384000000154e-05, 9.816384000000154e-05, 9.826384000000154e-05, 9.836384000000154e-05, 9.846384000000155e-05, 9.856384000000155e-05, 9.866384000000155e-05, 9.876384000000155e-05, 9.886384000000155e-05, 9.896384000000156e-05, 9.906384000000156e-05, 9.916384000000156e-05, 9.926384000000156e-05, 9.936384000000157e-05, 9.946384000000157e-05, 9.956384000000157e-05, 9.966384000000157e-05, 9.976384000000158e-05, 9.986384000000158e-05, 9.996384000000158e-05, 1.000000000000000e-04 };
            double[] refv = { 0.000000000000000e+00, 2.239817741876363e-15, 2.239817741876363e-15, 4.479635483752727e-15, 2.015826085360747e-14, 2.687741761327433e-14, 2.911663146063164e-14, 2.015687742946021e-14, 2.239477400652633e-14, 2.015213570273609e-14, 2.014581687096890e-14, 2.013319109241216e-14, 2.457642852013472e-14, 2.451504933961265e-14, 2.439320651837703e-14, 2.854459628409885e-14, 2.935625213324749e-14, 2.668750193931590e-14, 2.401875174538431e-14, 1.868125135752113e-14, 1.868125135752113e-14, 1.601250116358954e-14, 1.601250116358954e-14, 2.135000155145272e-14, 2.668750193931590e-14, 2.668750193931590e-14, 2.935625213324749e-14, 2.935625213324749e-14, 3.736250271504226e-14, 3.469375252111067e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.202500232717908e-14, 3.135962464852910e-14 };

            // Run simulation
            tran.OnExportSimulationData += (object sender, SimulationDataEventArgs args) =>
            {
                double actual = exports[0](args.Circuit.State);
                double expected = references[0](args.GetTime());
                plotInput.Points.AddXY(args.GetTime(), actual);
                plotOutput.Points.AddXY(args.GetTime(), actual - expected);
            };
            tran.Run(ckt);

            for (int i = 0; i < reft.Length; i++)
            {
                plotSpice.Points.AddXY(reft[i], refv[i]);
            }
        }

        /// <summary>
        /// Create a diode with a model
        /// </summary>
        /// <param name="name">Diode name</param>
        /// <param name="anode">Anode</param>
        /// <param name="cathode">Cathode</param>
        /// <param name="model">Model</param>
        /// <param name="modelparams">Model parameters</param>
        /// <returns></returns>
        protected static Diode CreateDiode(Identifier name, Identifier anode, Identifier cathode, Identifier model, string modelparams)
        {
            Diode d = new Diode(name);
            DiodeModel dm = new DiodeModel(model);
            ApplyParameters(dm, modelparams);
            d.SetModel(dm);
            d.Connect(anode, cathode);
            return d;
        }

        /// <summary>
        /// Apply a parameter definition to an entity
        /// Parameters are a series of assignments [name]=[value] delimited by spaces.
        /// </summary>
        /// <param name="entity">Entity</param>
        /// <param name="definition">Definition string</param>
        protected static void ApplyParameters(Entity entity, string definition)
        {
            // Get all assignments
            definition = Regex.Replace(definition, @"\s*\=\s*", "=");
            string[] assignments = definition.Split(new char[] { ',', ';', ' ' }, StringSplitOptions.RemoveEmptyEntries);
            foreach (var assignment in assignments)
            {
                // Get the name and value
                string[] parts = assignment.Split('=');
                if (parts.Length != 2)
                    throw new Exception("Invalid assignment");
                string name = parts[0].ToLower();
                double value = double.Parse(parts[1], System.Globalization.CultureInfo.InvariantCulture);

                // Set the entity parameter
                entity.Parameters.Set(name, value);
            }
        }
    }
}